<!doctype html>

<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Building games for the modern web</title>
    <link rel="Stylesheet" type="text/css" href="style.css" />
</head>
  <body>

    <div id="impress" class="impress-not-supported">

        <div id="presentation-title" class="step slide" data-x="-1000" data-y="0">
            <h1>Building games for the modern web</h1>
        </div>
        
         <div class="step slide" data-x="0" data-y="0">
          <h1>A brief history</h1>
        </div>
        
        <!-- Warner Brothers Quiz Website -->
        <!-- City of the .... whatever -->
        <!-- Runescape -->
        <!-- Braid (NaCL) -->
        <!-- Angry Birds (WebGL)) -->
        <!-- Zynga -->
        <div class="step slide" data-x="1000" data-y="0">
          <h1>Why the web?</h1>
        </div>
        
        <div class="step slide" data-x="2000" data-y="0">
          <h1>Easy route to market</h1>
        </div>
        
        <div class="step slide" data-x="3000" data-y="0">
          <h1>Support ALL the devices!</h1>
        </div>
        
        <div class="step slide" data-x="4000" data-y="0">
          <h1>It's fun!</h1>     
        </div>
        
        <div class="step slide" data-x="5000" data-y="0">
          <h1>Get rich (but probably not)</h1>
        </div>
        
        <div class="step slide" data-x="6000" data-y="0">
          <h1 class="top">What are our options?</h1>
          <ul>
            <li>WebGL</li>
            <li>Canvas</li>
            <li>HTML + CSS3</li>
            <li>NaCL</li>
            <li>Unity Web Player</li>
            <li>Flash</li>
          </ul>
        </div>

        <div class="step slide" data-rotate-y="180" data-x="6000" data-y="0">
          <h1 class="top">What are our options?</h1>
          <ul>
            <li><strong>WebGL</strong></li>
            <li><strong>Canvas</strong></li>
            <li><strong>HTML + CSS3</strong></li>
            <li><strike>NaCL</strike></li>
            <li><strike>Unity Web Player</strike></li>
            <li><strike>Flash</strike></li>
          </ul>
        </div>
        
        <div class="step slide" data-x="6000" data-y="0">
          <h1>HTML5 Canvas</h1>     
        </div>
        
        <div class="step slide" data-x="0" data-y="1500">
          <h1 class="top">HTML5 Canvas</h1>   
          <ul>
            <li>Immediate mode</li>
            <li>Low level</li>
            <li>Draw some shapes plz</li>
          </ul>     
        </div>

        <div class="step code" data-x="1000" data-y="1500">
          <h2>Given a canvas element like so</h2>
          <pre class="demo" data-src="canvas-example-1">
          </pre>
        </div>
        
        <div class="step code" data-x="2000" data-y="1500">
          <h2>We can draw to it like this</h2>
          <pre class="demo" data-src="canvas-example-1-src">
          </pre>   
        </div>
        
        <div class="step slide" data-x="3000" data-y="1500">
          <h2>Leading to something like this</h2>
          <div id="canvas-example-1">  
            <canvas id="canvas-example-1-target" width="640" height="480">
              Sorry, canvas isn't supported in this browser
            </canvas>
          </div>
          <script type="text/javascript" id="canvas-example-1-src">
            var canvas = document.getElementById('canvas-example-1-target');
            var context = canvas.getContext('2d');

            context.fillStyle = '#000';
            context.fillRect(50, 50, 100, 100);
          </script>
        </div>

        <!-- Some demos -->
        <div class="step slide" data-x="4000" data-y="1500">
          <h1>Let's dive a little deeper...</h1>
        </div>

        <div class="step slide" data-x="5000" data-y="1500">
          <h1 class="top">Happy face</h1>
          <ul>
            <li>Runs nearly everywhere</li>
            <li>Simple to use</li>
            <li>Rapid development, instant gratification</li>
            <li>Control over nearly 'everything'</li>
          </ul>
        </div>

        <div class="step slide" data-x="6000" data-y="1500">
          <h1 class="top">Sad face</h1>
          <ul>
            <li>Poor hardware acceleration support</li>
            <li>It's slooooooooow (except in IE)</li>
            <li>Learning curve is deceptive</li>
            <li>Struggles at higher resolutions</li>
          </ul>
        </div>

        <!-- TODO: Maybe go off and do some performance related demos -->
        
        <div class="step slide" data-x="0" data-y="3000">
          <h1>HTML+CSS</h1> 
        </div>
        
         <div class="step slide" data-x="1000" data-y="3000">
          <h1 class="top">HTML+CSS</h1>
          <ul>
            <li>Plain ol' HTML</li>
            <li>Retained mode graphics</li>
            <li>High level... I guess</li>
            <li>Highly optimised(!!)</li>
          </ul>
        </div>
        
        <div class="step code" data-x="2000" data-y="3000">
          <h2>Given a container like this</h2>
          <pre class="demo" data-src="html-example-1">
          </pre>
        </div>    

        <div class="step code" data-x="3000" data-y="3000">
          <h2>And some code like this</h2>
          <pre class="demo" data-src="html-example-1-src">
          </pre>
        </div>  

        <div class="step slide" id="htmlexample" data-x="4000" data-y="3000">
          <h2>We can have something like this</h2>
          <div id="html-example-1">  
            <div id="html-example-1-target" class="game" width="640" height="480">
            </div>
          </div>
          <script type="text/javascript" id="html-example-1-src">
            function htmlexample() {
              var target = document.getElementById('html-example-1-target');
              
              var sprite = document.createElement('div');
              sprite.style.width = 100 + 'px';
              sprite.style.height = 100 + 'px';
              sprite.style.top = 10 + 'px';
              sprite.style.left = 10 + 'px';
              sprite.style['background-color'] = '#000';
              target.appendChild(sprite);
            }
          </script>
        </div>    

        <div class="step slide" data-x="5000" data-y="3000">
          <h1 class="top">Hardware acceleration</h1>
          <p>Manipulating the DOM is expensive...</p>
          <ul>
            <li>Consider grouping items</li>
            <li>Consider CSS transitions</li>
          </ul>
        </div>

        <div class="step slide" data-x="6000" data-y="3000">
          <h1>Let's dive a little deeper</h1>
        </div>

        <div class="step slide" data-x="7000" data-y="3000">
          <h1 class="top">Happy face</h1>
          <ul>
            <li>Runs absolutely everywhere</li>
            <li>Little 'new' learning required</li>
            <li>Pretty darned fast.</li>
            <li>Great for fullscreen apps</li>
          </ul>
        </div>

        <div class="step slide" data-x="8000" data-y="3000">
          <h1 class="top">Sad face</h1>
          <ul>
            <li>Poor performance for constant 'updates'</li>
            <li>Fiddly to get 'right'</li>
            <li>Not designed for this kind of work</li>
            <li>Struggles with large number of objects</li>
          </ul>
        </div>

         <div class="step slide" data-x="0" data-y="4500">
          <h1>WebGL</h1>
          <ul>
            <li>A standard for hardware accelerated 3D graphics in the browser</li>
            <li>Cross platform, cross browser, pretty</li> 
            <li>Driven by JavaScript</li>
          </ul>
        </div>
        
        <div class="step slide" data-x="1000" data-y="4500">
          <h1>WebGL</h1>
          <ul>
            <li>OpenGL ES 2.0 API</li>
            <li>+ HTML5 Canvas</li>
            <li>= 3D games for the browser</li>
            <li>Not for the weak hearted</li>
          </ul>
        </div>
        
        <div class="step code" data-x="2000" data-y="4500">
          <h2>Getting a WebGL context</h2>
          <pre>
var canvas = document.getElementById('basic-webgl');
var gl = canvas.getContext('experimental-webgl');
          </pre>       
        </div>
        
        <div class="step code" data-x="3000" data-y="4500">
          <h2>Initial set up</h2>
          <p>Setting the colour we want the backbuffer cleared to</p>
          <pre>
gl.clearColor(1.0, 1.0, 1.0, 1.0);
          </pre>       
        </div>
        
        <div class="step code" data-x="4000" data-y="4500">
          <h2>Render loop</h2>
          <p>For example</p>
          <pre>
setInterval(function() {

  gl.viewport(0, 0, canvas.width, canvas.height);
  gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);
          
}, 250);  
          </pre>       
        </div>
        
        <div class="step slide" data-x="5000" data-y="4500">
          <h1>How about drawing something?</h1>     
          <p>Well, first we need some basic concepts</p>
        </div>
        
        <div class="step slide" data-x="6000" data-y="4500">
          <h1>Buffers</h1>   
          <ul>
            <li>Many kinds of buffer</li>
            <li>Created for communication with GPU</li>
            <li>For example, an array of vertex positions</li>
          </ul>     
        </div>
        
        <div class="step code" data-x="7000" data-y="4500">
          <h2>A square</h2>
          <pre>
var vertices = [
   0.0, 0.0, 0.0,
   1.0, 0.0, 0.0,
   0.0, 1.0, 0.0,
   1.0, 1.0, 0.0
];

var vertexBuffer = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);
gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.STATIC_DRAW);  
          </pre>   
        </div>
      
        <div class="step slide" data-x="8000" data-y="4500">
          <h1>Matrices</h1>   
          <ul>
            <li>Sorry... it's maths</li>
            <li>Used for transformations</li>
            <li>Will hide most of the maths with glMatrix (third party library)</li>
            <li><a href="https://github.com/toji/gl-matrix">github.com/toji/gl-matrix</a></li>
          </ul>     
        </div>
        
        <div class="step code" data-x="9000" data-y="4500">
          <h2>A basic world matrix</h2>
          <p>Used to transform coordinates from 'model space' into 'world space'</p>
          <pre>
var world = mat4.create();
mat4.identity(world); // Set to identity
mat4.translate(world, [0, 0, -10]); // Translate back 10 units
mat4.rotate(world, Math.PI/2, [0, 1, 0]); // Rotate 90 degrees around the Y axis
mat4.scale(world, [2, 2, 2]); // Scale by 200%
          </pre>   
        </div>
        
         <div class="step code" data-x="10000" data-y="4500">
          <h2>A basic view matrix</h2>
          <p>Used to transform coordinates from 'world space' into 'camera space'</p>
          <pre>
var view = mat4.create();

// Look at 0,0,0
// From 0,0,-100
// 'Up' is the Y axis
mat4.lookAt([0, 0, 0], [0, 0, -100], [0, 1, 0], view);
          </pre>   
        </div>
        
        <div class="step code" data-x="11000" data-y="4500">
          <h2>A basic projection matrix</h2>
          <p>Used to project coordinates into screen space</p>
          <pre>
var projection = mat4.create();

// Field of view is 45 degrees
// Aspect ratio is 4:3
// Clamp viewing distance from 1.0 to 100
mat4.perspective(45, 4/3, 1, 100, projection);
          </pre>   
        </div>         
        
        <div class="step slide" data-x="12000" data-y="4500">
          <h1>Quick maths lesson</h1>
          <p>Given a position 'P' on a model, as a vector (x,y,z)</p>
          <ul>
            <li>Multiply by world matrix to get its position in the game world</li>
            <li>Multiply that by the view matrix to get its position relative to camera</li>
            <li>Multiply that by projection matrix to get position on screen</li>
          </ul>       
        </div>
        
        <div class="step slide" data-x="13000" data-y="4500">
          <h1>Shaders</h1>
          <ul>
            <li>Two types of shader, <strong>vertex</strong> and <strong>fragment</strong></li>
            <li>Programs that operate on data that has been sent to the GPU</li>
            <li>Written in GLSL</li>
          </ul>        
        </div>
        
        <div class="step code" data-x="14000" data-y="4500">
          <h2>A vertex shader</h2>
          <p>For each item in an uploaded buffer, execute this</p>
          <pre>
attribute vec3 aVertexPosition; // The position of an uploaded vertex
uniform mat4 uProjection;       // An uploaded projection matrix
uniform mat4 uView;             // An uploaded view matrix
uniform mat4 uWorld;            // An uploaded world matrix

void main(void){
  gl_Position =   uProjection * uView * uWorld * vec4(aVertexPosition, 1.0);
}
          </pre>       
        </div>
        
         <div class="step code" data-x="15000" data-y="4500">
          <h2>A fragment shader</h2>
          <p>For each pixel being rendered to the screen</p>
          <pre>
void main(void) {

  // White
  gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);
}
          </pre>       
        </div>
        
         <div class="step code" data-x="16000" data-y="4500">
          <h2>Building a shader</h2>
          <p>Compiling a vertex shader</p>
          <pre>
var vertexText = document.getElementById('triangles-vertex').innerText;
var vertexShader = gl.createShader(gl.VERTEX_SHADER);
gl.shaderSource(vertexShader, vertexText);
gl.compileShader(vertexShader);
          </pre>       
        </div>  
        
         <div class="step code" data-x="17000" data-y="4500">
          <h2>Building a shader</h2>
          <p>Compiling a fragment shader</p>
          <pre>
var fragmentText = document.getElementById('triangles-fragment').innerText;
var fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);
gl.shaderSource(fragmentShader, fragmentText);
gl.compileShader(fragmentShader);
          </pre>       
        </div>
        
         <div class="step code" data-x="18000" data-y="4500">
          <h2>Building a shader</h2>
          <p>Putting the shader together</p>
          <pre>
var program = gl.createProgram(); 

gl.attachShader(program, vertexShader);
gl.attachShader(program, fragmentShader);
gl.linkProgram(program);
          </pre>       
        </div>
        
         <div class="step code" data-x="19000" data-y="4500">
          <h2>Building a shader</h2>
          <p>Extracting the inputs from the compiled shader</p>
          <pre>
var aVertexPosition = gl.getAttribLocation(program, 'aVertexPosition');
var uProjection = gl.getUniformLocation(program, 'uProjection');
var uView = gl.getUniformLocation(program, 'uView');
var uWorld = gl.getUniformLocation(program, 'uWorld');
          </pre>       
        </div>
        
        <div class="step slide" data-x="20000" data-y="4500">
          <h1>Nearly there</h1>
          <p>All of that was just loading and setting up!!</p>
          <p>Now our render method...</p>
        </div>
        
        <div class="step code" data-x="21000" data-y="4500">
          <h2>Setting the input variables</h2>
          <p>We have the locations, we've created the matrices so..</p>
          <pre>
gl.useProgram(program);

gl.uniformMatrix4fv(uProjection, false, projection);
gl.uniformMatrix4fv(uView, false, view);
gl.uniformMatrix4fv(uWorld, false, world);
          </pre>       
        </div>
        
        <div class="step code" data-x="22000" data-y="4500">
          <h2>Uploading the buffer</h2>
          <p>Our buffer contains four positions, each containing an X, Y and Z</p>
          <pre>
gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);
gl.vertexAttribPointer(aVertexPosition, 3, gl.FLOAT, false, 0, 0);
gl.enableVertexAttribArray(aVertexPosition);
          </pre>       
        </div>
        
        <div class="step code" data-x="23000" data-y="4500">
          <h2>Rendering</h2>
          <p>We've uploaded all the info to the GPU, we just need to tell it what to do</p>
          <pre>
            gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);
          </pre>       
        </div>s
               
        <div class="step" id="webXgl-squares" data-x="23000" data-rotate-y="180" data-y="4500">
          <canvas width="640" height="480" id="square-webgl">
        
          </canvas>
        </div>

        <div class="step slide" data-x="24000" data-y="4500">
          <h1>Let's dive a little deeper</h1>
        </div>

        <div class="step slide" data-x="25000" data-y="4500">
          <h1>Happy face</h1>
          <ul>
            <li>Super fast!</li>
            <li>Familiar API for mobile devs</li>
            <li>Full control</li>
          </ul>
        </div>

        <div class="step slide" data-x="26000" data-y="4500">
          <h1>Sad face</h1>
          <ul>
            <li>Super low level</li>
            <li>Lots of learning required</li>
            <li>Not supported everywhere</li>
          </ul>
        </div>

        <div class="step slide" data-x="0" data-y="6000">
          <h1>A note on audio</h1>
        </div>

        <div class="step code" data-x="1000" data-y="6000">
          <h1>Audio use</h1>
          <pre>
var audio = new Audio();
audio.url = 'myfile.wav';
audio.play();
          </pre>
        </div>

        <div class="step slide" data-x="2000" data-y="6000">
          <h1 class="top">Audio Support</h1>
          <table>
            <thead>
              <tr>
                <td>Browser</td><td>OGG</td><td>WAV</td><td>MP3</td><td>AAC</td>
              </tr>
            </thead>
            <tbody>
                <tr><td>IE</td>         <td></td><td></td><td>X</td><td>X</td></tr>
                <tr><td>Opera</td>      <td>X</td><td>X</td><td></td><td></td></tr>
                <tr><td>Firefox</td>    <td>X</td><td>X</td><td></td><td></td></tr>
                <tr><td>Chrome</td>     <td>X</td><td>X</td><td>X</td><td>X</td></tr>
            </tbody>
          </table>
        </div>

        <div class="step slide" data-x="2000" data-y="6000">
          <h1 class="top">Audio Support</h1>
          <table>
            <thead>
              <tr>
                <td>Browser</td><td>OGG</td><td>WAV</td><td>MP3</td><td>AAC</td>
              </tr>
            </thead>
            <tbody>
                <tr><td>IE</td>         <td></td><td></td><td>X</td><td></td></tr>
                <tr><td>Opera</td>      <td>X</td><td></td><td></td><td></td></tr>
                <tr><td>Firefox</td>    <td>X</td><td></td><td></td><td></td></tr>
                <tr><td>Chrome</td>     <td>X</td><td></td><td>X</td><td></td></tr>
            </tbody>
          </table>
        </div>

        <div class="step slide" data-x="3000" data-y="6000">
          <h2>Audio Support</h2>
          <ul>
            <li>Kinda sucks really</li>
            <li>Consider "Buzz" or similar: <strong>github.com/jaysalvat/buzz</strong></li>
          </ul>          
        </div>

        <div class="step slide" data-x="0" data-y="7500">
          <h1>So here we are</h1>
        </div>

        <div class="step slide" data-x="1000" data-y="7500">
          <h1 class="top">Use Canvas when...</h1>
          <ul>
            <li>You're building for fast machines</li>
            <li>You can cache the results easily</li>
            <li>You're working with a small surface area</li>
          </ul>
        </div>

        <div class="step slide" data-x="2000" data-y="7500">
          <h1 class="top">Use the DOM when...</h1>
          <ul>
            <li>You *really* want mobile support</li>
            <li>You're not moving a lot of things</li>
            <li>You're going full-screen</li>
          </ul>
        </div>
        
        <div class="step slide" data-x="3000" data-y="7500">
          <h1 class="top">Use WebGL when...</h1>
          <ul>
            <li>You don't care about IE</li>
            <li>You don't care about iPad</li>
            <li>You want to show off</li>
          </ul>
        </div>

        <div class="step slide" data-x="4000" data-y="7500">
          <h1 class="top">Use native when...</h1>
          <ul>
            <li>You want the best performance</li>
            <li>You don't like Javascript</li>
            <li>You don't like hard work</li>
          </ul>
        </div>

        <div class="step slide" data-x="5000" data-y="7500">
          <h1 class="top">So what have we learned?</h1>
          <ul>
            <li>We have a lot of choices</li>
            <li>They all suck a bit</li>
            <li>But it is fun?</li>
          </ul>
        </div>

        <div class="step" id="farout" data-rotate-y="50" data-x="18000" data-y="4000" data-scale="15">
          <h1 id="zoomed">@robashton</h1>          
        </div>

      <!--
          So to make a summary of all the possible attributes used to position presentation steps, we have:
          
          * `data-x`, `data-y`, `data-z` -- they define the position of **the center** of step element on
              the canvas in pixels; their default value is 0;
          * `data-rotate-x`, `data-rotate-y`, 'data-rotate-z`, `data-rotate` -- they define the rotation of
              the element around given axis in degrees; their default value is 0; `data-rotate` and `data-rotate-z`
              are exactly the same;
          * `data-scale` -- defines the scale of step element; default value is 1
      -->

    </div>
    
    <script src="jquery.js"></script>
    <script src="glmatrix.js"></script>
    <script src="impress.js"></script>
    <script src="demos.js"></script>
    <script src="squares.js"></script>
    
    <div id="triangles-vertex" style="display: none;">attribute vec3 aVertexPosition;
uniform mat4 uProjection;
uniform mat4 uView;
uniform mat4 uWorld;

void main(void){
  gl_Position =  uProjection * uView * uWorld * vec4(aVertexPosition, 1.0);
}</div>
    
    <div id="triangles-fragment" style="display: none;">#ifdef GL_ES
precision highp float;
#endif
void main(void) {
  gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);
}</div>
   
  </body>

</html>
